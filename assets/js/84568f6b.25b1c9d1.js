"use strict";(globalThis.webpackChunkexpo_iap_docs=globalThis.webpackChunkexpo_iap_docs||[]).push([[3860],{1506:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});var s=i(3722),o=i(4848),r=i(8453);const t={slug:"3.1.0",title:"3.1.0 - Full OpenIAP Ecosystem Adoption",authors:["hyochan"],tags:["release","openiap","ios","android","tooling"],date:new Date("2025-09-21T00:00:00.000Z")},l="3.1.0 Release Notes",a={authorsImageUrls:[void 0]},d=[{value:"\ud83d\ude80 Highlights",id:"-highlights",level:2},{value:"\ud83d\udd01 OpenIAP Upgrades",id:"-openiap-upgrades",level:2},{value:"\ud83d\udc1e Bug Fixes",id:"-bug-fixes",level:2},{value:"\ud83d\udee1\ufe0f Safer Purchases &amp; Better Errors",id:"\ufe0f-safer-purchases--better-errors",level:2},{value:"\ud83d\udee0\ufe0f Tooling &amp; Workflow",id:"\ufe0f-tooling--workflow",level:2},{value:"\u26a0\ufe0f Important Changes",id:"\ufe0f-important-changes",level:2},{value:"Minor Updates",id:"minor-updates",level:2},{value:"\ud83d\udce6 Installation",id:"-installation",level:2},{value:"\ud83d\udd17 References",id:"-references",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Expo IAP 3.1.0 graduates the project into the full ",(0,o.jsx)(n.strong,{children:"OpenIAP ecosystem"}),". The release ships with three dedicated native stacks:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-apple",children:"openiap-apple"})})," \u2014 StoreKit 2 implementation for Apple platforms"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-google",children:"openiap-google"})})," \u2014 Google Play Billing integration for Android"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-gql",children:"openiap-gql"})})," \u2014 GraphQL helpers that drive types and tooling"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["From 3.1.0 onward, Expo IAP stays in lockstep with these modules: Apple ",(0,o.jsx)(n.strong,{children:"v1.2.2"}),", Google ",(0,o.jsx)(n.strong,{children:"v1.2.6"}),", and GQL ",(0,o.jsx)(n.strong,{children:"v1.0.8"}),". That shared version alignment gives Expo IAP stable native compatibility and a unified type system straight from the OpenIAP schema."]}),"\n",(0,o.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/releases/tag/3.1.0",children:"View the 3.1.0 release"})]}),"\n",(0,o.jsx)(n.h2,{id:"-highlights",children:"\ud83d\ude80 Highlights"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Adopted the full OpenIAP core stack\u2014",(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-gql",children:"openiap-gql"}),", ",(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-apple",children:"openiap-apple"})," v1.2.2, and ",(0,o.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-google",children:"openiap-google"})," v1.2.6)\u2014bringing Expo IAP into alignment with the shared ecosystem used across Flutter, React Native, and KMP."]}),"\n",(0,o.jsxs)(n.li,{children:["Trimmed roughly ",(0,o.jsx)(n.strong,{children:"two thirds"})," of our custom native bridge code by delegating logic to the OpenIAP modules."]}),"\n",(0,o.jsxs)(n.li,{children:["Expanded automated coverage to about ",(0,o.jsx)(n.strong,{children:"98%"}),", spanning purchase flows, native bridge entry points, and error mapping utilities."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"-openiap-upgrades",children:"\ud83d\udd01 OpenIAP Upgrades"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Normalized purchase payloads on both platforms so every bridge call sanitizes platform casing and forwards the complete OpenIAP record."}),"\n",(0,o.jsxs)(n.li,{children:["Migrated Android to the new ",(0,o.jsx)(n.code,{children:"RequestPurchaseProps"})," / ",(0,o.jsx)(n.code,{children:"PurchaseResult"})," / ",(0,o.jsx)(n.code,{children:"ErrorCode"})," contracts, achieving parity with the Apple module."]}),"\n",(0,o.jsxs)(n.li,{children:["Centralized native dependency versions via ",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/blob/main/openiap-versions.json",children:(0,o.jsx)(n.code,{children:"openiap-versions.json"})}),"; Gradle now fails fast if the Google artifact version is missing and scripts/migrations read from one source of truth."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"-bug-fixes",children:"\ud83d\udc1e Bug Fixes"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"fix(android): honor subscription offerToken"})," (",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/pull/214",children:"#214"}),") restores proper handling of ",(0,o.jsx)(n.code,{children:"subscriptionOfferDetailsAndroid"})," so Google Play discounts apply reliably."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\ufe0f-safer-purchases--better-errors",children:"\ud83d\udee1\ufe0f Safer Purchases & Better Errors"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"requestPurchase"})," on iOS explicitly rejects unsupported product types instead of silently treating ",(0,o.jsx)(n.code,{children:"all"})," as ",(0,o.jsx)(n.code,{children:"in-app"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Error handling now consistently routes through the shared ",(0,o.jsx)(n.code,{children:"ErrorCode"})," table so promise rejections, platform conversions, and predicates remain aligned."]}),"\n",(0,o.jsxs)(n.li,{children:["Additional coverage for ",(0,o.jsx)(n.code,{children:"createPurchaseError"}),", ",(0,o.jsx)(n.code,{children:"ErrorCodeUtils"}),", and the user-friendly error helper keeps error copy in sync with OpenIAP terminology."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\ufe0f-tooling--workflow",children:"\ud83d\udee0\ufe0f Tooling & Workflow"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Contributor docs clarify how to bump OpenIAP packages, regenerate types, and keep ",(0,o.jsx)(n.code,{children:"openiap-versions.json"})," synchronized for Android and iOS builds."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\ufe0f-important-changes",children:"\u26a0\ufe0f Important Changes"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Transaction identifiers"}),": ",(0,o.jsx)(n.code,{children:"transactionId"})," is reinstated as the primary store reference (",(0,o.jsx)(n.code,{children:"orderId"})," on Android, StoreKit transaction ID on iOS). Android\u2019s generic ",(0,o.jsx)(n.code,{children:"id"})," is no longer repurposed for orders; when Google Play omits an ",(0,o.jsx)(n.code,{children:"orderId"})," (typical for consumables), ",(0,o.jsx)(n.code,{children:"transactionId"})," becomes ",(0,o.jsx)(n.code,{children:"null"})," and clients should rely on the unified ",(0,o.jsx)(n.code,{children:"purchaseToken"})," (Android purchase token / iOS JWS). This value is the canonical receipt for server validation. See the related ",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/react-native-iap/discussions/3016",children:"react-native-iap discussion"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"iOS request types"}),": purchase requests must specify either ",(0,o.jsx)(n.code,{children:"in-app"})," or ",(0,o.jsx)(n.code,{children:"subs"}),". Passing ",(0,o.jsx)(n.code,{children:"all"})," (or any other type) throws an explicit error."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Promoted products"}),": events now emit the full sanitized product payload; downstream listeners should expect the entire object instead of just ",(0,o.jsx)(n.code,{children:"productId"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Deprecated helpers removed"}),": ",(0,o.jsx)(n.code,{children:"getProducts"}),", ",(0,o.jsx)(n.code,{children:"requestSubscription"}),", and ",(0,o.jsx)(n.code,{children:"requestProducts"})," are removed. Use ",(0,o.jsx)(n.code,{children:"fetchProducts"})," with the unified purchase flow."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"minor-updates",children:"Minor Updates"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Removed the legacy ",(0,o.jsx)(n.code,{children:"useIAP"})," state shims (",(0,o.jsx)(n.code,{children:"currentPurchase"}),", ",(0,o.jsx)(n.code,{children:"currentPurchaseError"}),", and their ",(0,o.jsx)(n.code,{children:"clear*"})," helpers) in favour of the hook\u2019s ",(0,o.jsx)(n.code,{children:"onPurchaseSuccess"})," / ",(0,o.jsx)(n.code,{children:"onPurchaseError"})," callbacks (",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/pull/213",children:"#213"}),")."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"-installation",children:"\ud83d\udce6 Installation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"bun add expo-iap@3.1.0\n# or\nnpm install expo-iap@3.1.0\n# or\nyarn add expo-iap@3.1.0\n"})}),"\n",(0,o.jsx)(n.h2,{id:"-references",children:"\ud83d\udd17 References"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Recent work: ",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/pulls?q=is%3Apr+is%3Aclosed",children:"Closed pull requests"})]}),"\n",(0,o.jsxs)(n.li,{children:["Release builds on the OpenIAP ecosystem: ",(0,o.jsx)(n.a,{href:"https://openiap.dev",children:"openiap.dev"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Enjoy the smoother upgrade path and richer diagnostics shipped in 3.1.0! Let us know how it goes via ",(0,o.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/issues",children:"GitHub issues"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},3722:e=>{e.exports=JSON.parse('{"permalink":"/expo-iap/blog/3.1.0","editUrl":"https://github.com/hyochan/expo-iap/tree/main/docs/blog/2025-09-21-3.1.0.md","source":"@site/blog/2025-09-21-3.1.0.md","title":"3.1.0 - Full OpenIAP Ecosystem Adoption","description":"Expo IAP 3.1.0 graduates the project into the full OpenIAP ecosystem. The release ships with three dedicated native stacks:","date":"2025-09-21T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/expo-iap/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"OpenIAP","permalink":"/expo-iap/blog/tags/openiap","description":"OpenIAP related notes"},{"inline":false,"label":"iOS","permalink":"/expo-iap/blog/tags/ios","description":"iOS platform specific features"},{"inline":false,"label":"Android","permalink":"/expo-iap/blog/tags/android","description":"Android platform specific features"},{"inline":false,"label":"Tooling","permalink":"/expo-iap/blog/tags/tooling","description":"Tooling and build pipeline updates"}],"readingTime":3.04,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Expo IAP Maintainer","url":"https://github.com/hyochan","page":{"permalink":"/expo-iap/blog/authors/hyochan"},"socials":{"github":"https://github.com/hyochan","linkedin":"https://www.linkedin.com/in/hyochanjang/","x":"https://x.com/hyodotdev"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"3.1.0","title":"3.1.0 - Full OpenIAP Ecosystem Adoption","authors":["hyochan"],"tags":["release","openiap","ios","android","tooling"],"date":"2025-09-21T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"3.1.9 - Alternative Billing Support","permalink":"/expo-iap/blog/3.1.9"},"nextItem":{"title":"3.0.0 \u2014 OpenIAP Integration, Unified Core, Leaner API","permalink":"/expo-iap/blog/3.0.0"}}')},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const o={},r=s.createContext(o);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);