"use strict";(globalThis.webpackChunkexpo_iap_docs=globalThis.webpackChunkexpo_iap_docs||[]).push([[1998],{571:(e,n,i)=>{i.d(n,{A:()=>l});var t=i(6540),s=i(4848);function r({className:e="adfit",style:n,unit:i,height:r,width:l}){return(0,t.useEffect)(()=>{const n=setTimeout(()=>{const n=document.querySelector(`.${e}`);if(!n)return void console.warn(`AdFit: Element with class "${e}" not found`);const t=n.querySelectorAll(".kakao_ad_area"),s=n.querySelectorAll('script[src*="kas/static/ba.min.js"]');t.forEach(e=>e.remove()),s.forEach(e=>e.remove());const a=document.createElement("ins"),d=document.createElement("script");a.className="kakao_ad_area",a.style.cssText="display:none; width:100%;",d.async=!0,d.type="text/javascript",d.src="//t1.daumcdn.net/kas/static/ba.min.js",a.setAttribute("data-ad-width",l.toString()),a.setAttribute("data-ad-height",r.toString()),a.setAttribute("data-ad-unit",i),n.appendChild(a),n.appendChild(d)},100);return()=>clearTimeout(n)},[e,i,r,l]),(0,s.jsx)("div",{style:n,children:(0,s.jsx)("div",{className:e})})}function l(){return(0,s.jsx)(r,{unit:"DAN-YTmjDwlbcP42HBg6",height:100,width:320,className:"adfit-top",style:{flex:1,marginTop:24,marginBottom:24}})}},2139:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});var t=i(5298),s=i(4848),r=i(8453),l=i(571);const a={slug:"2.9.0",title:"2.9.0 - OpenIAP Apple Integration",authors:["hyochan"],tags:["release","openiap","ios","architecture","performance"],date:new Date("2025-09-05T00:00:00.000Z")},d="2.9.0 Release Notes",o={authorsImageUrls:[void 0]},c=[{value:"\ud83c\udfaf OpenIAP Apple Integration",id:"-openiap-apple-integration",level:2},{value:"Code Reduction Impact",id:"code-reduction-impact",level:3},{value:"\ud83c\udfd7\ufe0f Architecture Evolution",id:"\ufe0f-architecture-evolution",level:2},{value:"Before (2.8.x)",id:"before-28x",level:3},{value:"After (2.9.0)",id:"after-290",level:3},{value:"\u2728 What&#39;s New",id:"-whats-new",level:2},{value:"Enhanced Type System",id:"enhanced-type-system",level:3},{value:"Thread Safety",id:"thread-safety",level:3},{value:"Unified Event System",id:"unified-event-system",level:3},{value:"\ud83d\udc1b Bug Fixes",id:"-bug-fixes",level:2},{value:"\ud83d\udc94 Breaking Changes",id:"-breaking-changes",level:2},{value:"IapEvent \u2192 OpenIapEvent",id:"iapevent--openiapevent",level:3},{value:"\ud83d\ude80 Looking Ahead: 3.0.0",id:"-looking-ahead-300",level:2},{value:"\ud83d\udca1 Benefits",id:"-benefits",level:2},{value:"\ud83d\udce6 Installation",id:"-installation",level:2},{value:"\ud83d\udccb Full Changelog",id:"-full-changelog",level:2},{value:"Added",id:"added",level:3},{value:"Changed",id:"changed",level:3},{value:"Fixed",id:"fixed",level:3},{value:"Note",id:"note",level:3},{value:"\ud83d\ude4f Acknowledgments",id:"-acknowledgments",level:2}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["We're excited to announce 2.9.0, featuring full integration with OpenIAP Apple that reduces our Swift codebase by ",(0,s.jsx)(n.strong,{children:"~1,180 lines (73% reduction)"}),"!"]}),"\n","\n",(0,s.jsx)(l.A,{}),"\n",(0,s.jsx)(n.h2,{id:"-openiap-apple-integration",children:"\ud83c\udfaf OpenIAP Apple Integration"}),"\n",(0,s.jsxs)(n.p,{children:["The core achievement of this release is integrating ",(0,s.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap-apple",children:"OpenIAP Apple"})," v1.1.5 as our iOS native module."]}),"\n",(0,s.jsx)(n.h3,{id:"code-reduction-impact",children:"Code Reduction Impact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Before"}),": 1,620 lines of Swift code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"After"}),": 440 lines of Swift code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reduction"}),": ~1,180 lines (73% less code to maintain!)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-architecture-evolution",children:"\ud83c\udfd7\ufe0f Architecture Evolution"}),"\n",(0,s.jsx)(n.h3,{id:"before-28x",children:"Before (2.8.x)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"Expo IAP \u2192 Custom Swift Implementation \u2192 StoreKit 2\n         (1,620 lines of complex logic)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"after-290",children:"After (2.9.0)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"Expo IAP \u2192 OpenIAP Apple \u2192 StoreKit 2\n         (440 lines)    (Specialized native module)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-whats-new",children:"\u2728 What's New"}),"\n",(0,s.jsx)(n.h3,{id:"enhanced-type-system",children:"Enhanced Type System"}),"\n",(0,s.jsxs)(n.p,{children:["Following ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/versions#v1-1-0",children:"OpenIAP v1.1.0 specification"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ProductRequest"})," for product fetching"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequestPurchaseProps"})," for purchase requests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ReceiptValidationProps"})," for receipt validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PurchaseError"})," with native error code mapping"]}),"\n",(0,s.jsxs)(n.li,{children:["No more deep imports: ",(0,s.jsx)(n.code,{children:"ProductAndroid"}),", ",(0,s.jsx)(n.code,{children:"ProductIOS"}),", ",(0,s.jsx)(n.code,{children:"PaymentDiscount"})," and other types are exported from ",(0,s.jsx)(n.code,{children:"expo-iap"})," root"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"thread-safety",children:"Thread Safety"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All iOS operations now use ",(0,s.jsx)(n.code,{children:"@MainActor"})," annotation"]}),"\n",(0,s.jsx)(n.li,{children:"Prevents race conditions and ensures main thread execution"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"unified-event-system",children:"Unified Event System"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Renamed ",(0,s.jsx)(n.code,{children:"IapEvent"})," to ",(0,s.jsx)(n.code,{children:"OpenIapEvent"})]}),"\n",(0,s.jsxs)(n.li,{children:["Streamlined listeners: ",(0,s.jsx)(n.code,{children:"purchaseUpdatedListener"}),", ",(0,s.jsx)(n.code,{children:"purchaseErrorListener"})]}),"\n",(0,s.jsxs)(n.li,{children:["Added ",(0,s.jsx)(n.code,{children:"removeAllListeners()"})," for cleanup"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-bug-fixes",children:"\ud83d\udc1b Bug Fixes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fixed duplicate purchase success alerts"}),"\n",(0,s.jsx)(n.li,{children:"Resolved restore purchase alerts on screen entry"}),"\n",(0,s.jsx)(n.li,{children:"Improved purchase validation logic"}),"\n",(0,s.jsx)(n.li,{children:"Enhanced subscription status refresh timing"}),"\n",(0,s.jsx)(n.li,{children:"Better deduplication of purchases by productId"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-breaking-changes",children:"\ud83d\udc94 Breaking Changes"}),"\n",(0,s.jsx)(n.h3,{id:"iapevent--openiapevent",children:"IapEvent \u2192 OpenIapEvent"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c Old\nimport {OpenIapEvent} from 'expo-iap';\n\npurchaseUpdatedListener((purchase) => {}, OpenIapEvent.PurchaseUpdated);\n\n// \u2705 New\nimport {OpenIapEvent} from 'expo-iap';\n\npurchaseUpdatedListener((purchase) => {}, OpenIapEvent.PurchaseUpdated);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-looking-ahead-300",children:"\ud83d\ude80 Looking Ahead: 3.0.0"}),"\n",(0,s.jsx)(n.p,{children:"This release sets the foundation for 3.0.0:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": OpenIAP Android integration (Google Play Billing)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bundle Size"}),": Further optimizations through shared native libraries"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Maintenance"}),": Unified native module architecture"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-benefits",children:"\ud83d\udca1 Benefits"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reliability"}),": Battle-tested native modules reduce edge cases"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Maintainability"}),": 73% less code in Expo IAP layer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": Optimized native implementations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Future-proof"}),": Easier platform updates"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-installation",children:"\ud83d\udce6 Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install expo-iap@2.9.0\n# or\nyarn add expo-iap@2.9.0\n# or\nbun add expo-iap@2.9.0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-full-changelog",children:"\ud83d\udccb Full Changelog"}),"\n",(0,s.jsx)(n.h3,{id:"added",children:"Added"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": Integrated OpenIAP Apple v1.1.6"]}),"\n",(0,s.jsx)(n.li,{children:"Updated types to match OpenIAP v1.1.0 specification"}),"\n",(0,s.jsxs)(n.li,{children:["Enhanced error handling with ",(0,s.jsx)(n.code,{children:"PurchaseError"})," type"]}),"\n",(0,s.jsxs)(n.li,{children:["New type system: ",(0,s.jsx)(n.code,{children:"ProductRequest"}),", ",(0,s.jsx)(n.code,{children:"RequestPurchaseProps"}),", ",(0,s.jsx)(n.code,{children:"ReceiptValidationProps"})]}),"\n",(0,s.jsxs)(n.li,{children:["Improved receipt validation with ",(0,s.jsx)(n.code,{children:"ReceiptValidationResult"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"changed",children:"Changed"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Updated ",(0,s.jsx)(n.code,{children:"serializePurchase"})," and ",(0,s.jsx)(n.code,{children:"serializeProduct"})," for new OpenIAP structure"]}),"\n",(0,s.jsx)(n.li,{children:"Updated listener setup to use new OpenIAP methods"}),"\n",(0,s.jsxs)(n.li,{children:["Renamed ",(0,s.jsx)(n.code,{children:"IapEvent"})," to ",(0,s.jsx)(n.code,{children:"OpenIapEvent"})," across entire codebase"]}),"\n",(0,s.jsxs)(n.li,{children:["Added unified ",(0,s.jsx)(n.code,{children:"removeAllListeners()"})," for cleanup"]}),"\n",(0,s.jsxs)(n.li,{children:["Avoid deep imports: import public types directly from ",(0,s.jsx)(n.code,{children:"expo-iap"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"fixed",children:"Fixed"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fixed duplicate purchase success alerts"}),"\n",(0,s.jsx)(n.li,{children:"Fixed restore purchase alerts on screen entry"}),"\n",(0,s.jsx)(n.li,{children:"Improved purchase validation logic"}),"\n",(0,s.jsx)(n.li,{children:"Enhanced subscription deduplication"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"note",children:"Note"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Android native module integration with OpenIAP Android planned for 3.0.0"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-acknowledgments",children:"\ud83d\ude4f Acknowledgments"}),"\n",(0,s.jsxs)(n.p,{children:["Special thanks to the ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev",children:"OpenIAP"})," project for providing standardized, high-quality native modules."]}),"\n",(0,s.jsxs)(n.p,{children:["For detailed changes, see ",(0,s.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/pull/184",children:"PR #184"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Questions? Visit ",(0,s.jsx)(n.a,{href:"https://github.com/hyochan/expo-iap/issues",children:"GitHub Issues"}),"!"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},5298:e=>{e.exports=JSON.parse('{"permalink":"/expo-iap/blog/2.9.0","editUrl":"https://github.com/hyochan/expo-iap/tree/main/docs/blog/2025-09-05-2.9.0.md","source":"@site/blog/2025-09-05-2.9.0.md","title":"2.9.0 - OpenIAP Apple Integration","description":"We\'re excited to announce 2.9.0, featuring full integration with OpenIAP Apple that reduces our Swift codebase by ~1,180 lines (73% reduction)!","date":"2025-09-05T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/expo-iap/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"OpenIAP","permalink":"/expo-iap/blog/tags/openiap","description":"OpenIAP related notes"},{"inline":false,"label":"iOS","permalink":"/expo-iap/blog/tags/ios","description":"iOS platform specific features"},{"inline":false,"label":"Architecture","permalink":"/expo-iap/blog/tags/architecture","description":"Architecture notes and updates"},{"inline":false,"label":"Performance","permalink":"/expo-iap/blog/tags/performance","description":"Performance improvements"}],"readingTime":2.32,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Expo IAP Maintainer","url":"https://github.com/hyochan","page":{"permalink":"/expo-iap/blog/authors/hyochan"},"socials":{"github":"https://github.com/hyochan","linkedin":"https://www.linkedin.com/in/hyochanjang/","x":"https://x.com/hyodotdev"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"2.9.0","title":"2.9.0 - OpenIAP Apple Integration","authors":["hyochan"],"tags":["release","openiap","ios","architecture","performance"],"date":"2025-09-05T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"3.0.0 \u2014 OpenIAP Integration, Unified Core, Leaner API","permalink":"/expo-iap/blog/3.0.0"},"nextItem":{"title":"2.8.0 Migration Guide - iOS Field Naming Convention Update","permalink":"/expo-iap/blog/2.8.0-migration-guide"}}')},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);