---
slug: v3-0-0
title: v3.0.0 — unified tokens, simplified API, iOS parity
tags: [release, breaking-change, android, ios]
---

v3.0.0 is a major cleanup release that removes long‑deprecated APIs, unifies token handling across platforms, and aligns iOS/Android behavior behind a smaller, clearer surface area.

Highlights

- Unified tokens: `Purchase.purchaseToken` is the single source for both iOS and Android. iOS no longer exposes `jwsRepresentationIOS`; use `purchaseToken` instead.
- Simpler API: Legacy helpers are gone — use `fetchProducts`, `requestPurchase`, `getAvailablePurchases`, and listeners.
- iOS parity: Only `*IOS` methods remain for iOS‑specific behavior. Also, `showManageSubscriptionsIOS()` now returns purchases (array) rather than just a boolean.
- Stronger types: Consolidated product/purchase types; removed legacy aliases and fields.

Breaking changes

- Removed functions
  - `getProducts`, `getSubscriptions`, `requestProducts`, `requestSubscription`
  - `getPurchaseHistory` / `getPurchaseHistories`
  - Non‑suffixed iOS aliases (use `*IOS` variants)

- Changed behavior
  - `showManageSubscriptionsIOS(): Promise<Purchase[]>` — now returns purchases instead of `boolean`.
  - `getAvailablePurchases` options: only accepts `alsoPublishToEventListenerIOS` and `onlyIncludeActiveItemsIOS`.

Quick migration

- Fetch products (in‑app or subs):

```ts
import { fetchProducts, type SubscriptionProduct } from 'expo-iap';

const inapps = await fetchProducts({ skus: ['prod1', 'prod2'], type: 'inapp' });

const subs = (await fetchProducts({
  skus: ['sub_monthly'],
  type: 'subs',
})) as SubscriptionProduct[];
```

- Request purchase (products or subs):

```ts
import { requestPurchase } from 'expo-iap';

// In‑app
await requestPurchase({
  request: { ios: { sku: 'prod1' }, android: { skus: ['prod1'] } },
  type: 'inapp',
});

// Subscriptions (Android supply offer tokens)
await requestPurchase({
  request: {
    ios: { sku: 'sub_monthly' },
    android: {
      skus: ['sub_monthly'],
      subscriptionOffers: [{ sku: 'sub_monthly', offerToken: 'your-offer-token' }],
    },
  },
  type: 'subs',
});
```

- Restore/available purchases:

```ts
import { getAvailablePurchases, restorePurchases } from 'expo-iap';

// iOS‑specific flags only
const purchases = await getAvailablePurchases({
  alsoPublishToEventListenerIOS: false,
  onlyIncludeActiveItemsIOS: true,
});

// Cross‑platform helper that syncs on iOS then lists
const restored = await restorePurchases({
  alsoPublishToEventListenerIOS: false,
  onlyIncludeActiveItemsIOS: true,
});
```

- Tokens and finishing transactions:

```ts
import { finishTransaction, type Purchase } from 'expo-iap';

function getToken(p: Purchase) {
  return p.purchaseToken; // iOS JWS or Android token
}

await finishTransaction({ purchase: somePurchase, isConsumable: true });
```

Notes

- iOS promoted products listener remains `promotedProductListenerIOS`.
- `getStorefront()` stays as the cross‑platform helper; call `getStorefrontIOS()` for iOS‑explicit.

Changelog

See `CHANGELOG.md` for the full list of changes in 3.0.0.

